-- CALL EDW_DATASET_LND_STG.S_M_ITEM_COST_YEARLY_EU("DCS_CORE_V","ITEM_COST_TEST_YEAR_END","202412","202401","1");
CREATE OR REPLACE PROCEDURE EDW_DATASET_LND_STG.S_M_ITEM_COST_YEARLY_EU(IN PRM_PARAM_CORE_DB string,IN PRM_PARAM_SRC_CORE_DB string, IN PRM_PARAM_TARGET_TABLENAME string, IN VAR_PERIOD_END string, IN VAR_PERIOD_START string, IN VAR_REGION_CODE string) 
 OPTIONS(strict_mode=false) 

BEGIN
  EXECUTE IMMEDIATE " CREATE OR REPLACE TABLE EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_COST_CUR_ACT AS( SELECT 1 AS DUMMY) ";

EXECUTE IMMEDIATE "  CREATE OR REPLACE TABLE EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT AS ( SELECT COST_CUR_ACT.ITEM_ID AS ITEM_ID , COST_CUR_ACT.DB_CODE AS DB_CODE , COST_CUR_ACT.SITE_CODE AS SITE_CODE , COST_CUR_ACT.COST_OF_GOOD AS COST_OF_GOOD , COST_CUR_ACT.MAT_COST_TL AS MAT_COST_TL , COST_CUR_ACT.LAB_COST_TL AS LAB_COST_TL , COST_CUR_ACT.BUR_COST_TL AS BUR_COST_TL , COST_CUR_ACT.OVH_COST_TL AS OVH_COST_TL , COST_CUR_ACT.SUB_COST_TL AS SUB_COST_TL , COST_CUR_ACT.MAT_COST_LL AS MAT_COST_LL , COST_CUR_ACT.LAB_COST_LL AS LAB_COST_LL , COST_CUR_ACT.BUR_COST_LL AS BUR_COST_LL , COST_CUR_ACT.OVH_COST_LL AS OVH_COST_LL , COST_CUR_ACT.SUB_COST_LL AS SUB_COST_LL , COST_CUR_ACT.DB_CURR AS DB_CURR , COST_CUR_ACT.MFG_UPD_DATE AS MFG_UPD_DATE , COST_CUR_ACT.INS_DATE AS INS_DATE , COST_CUR_ACT.UPD_DATE AS UPD_DATE , COST_CUR_ACT.MISSING AS MISSING , COST_CUR_ACT.REGION_CODE AS REGION_CODE FROM "||PRM_PARAM_SRC_CORE_DB||".COST_CUR_ACT  COST_CUR_ACT WHERE COST_CUR_ACT.REGION_CODE='"||VAR_REGION_CODE||"' )";

EXECUTE IMMEDIATE "  CREATE OR REPLACE TABLE EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_EXP_CUR AS ( SELECT M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.ITEM_ID AS ITEM_ID , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.DB_CODE AS DB_CODE , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.SITE_CODE AS SITE_CODE , 'C' AS COST_SET , "||VAR_PERIOD_START||"  AS PERIOD_START , "||VAR_PERIOD_END||" AS PERIOD_END , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.COST_OF_GOOD AS COST_OF_GOOD , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.MAT_COST_TL AS MAT_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.LAB_COST_TL AS LAB_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.BUR_COST_TL AS BUR_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.OVH_COST_TL AS OVH_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.SUB_COST_TL AS SUB_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.MAT_COST_LL AS MAT_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.LAB_COST_LL AS LAB_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.BUR_COST_LL AS BUR_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.OVH_COST_LL AS OVH_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.SUB_COST_LL AS SUB_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.DB_CURR AS DB_CURR , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.MFG_UPD_DATE AS MFG_UPD_DATE , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.INS_DATE AS INS_DATE , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.UPD_DATE AS UPD_DATE , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.MISSING AS MISSING , M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT.REGION_CODE AS REGION_CODE FROM EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT )";

EXECUTE IMMEDIATE "  INSERT INTO "||PRM_PARAM_CORE_DB||"."||PRM_PARAM_TARGET_TABLENAME||" ( ITEM_ID , DB_CODE , SITE_CODE , COST_SET , PERIOD_START , PERIOD_END , COST_OF_GOOD , MAT_COST_TL , LAB_COST_TL , BUR_COST_TL , OVH_COST_TL , SUB_COST_TL , MAT_COST_LL , LAB_COST_LL , BUR_COST_LL , OVH_COST_LL , SUB_COST_LL , DB_CURR , MFG_UPD_DATE , INS_DATE , UPD_DATE , MISSING , REGION_CODE ) ( SELECT SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.ITEM_ID AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.DB_CODE AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.SITE_CODE AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.COST_SET AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.PERIOD_START AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.PERIOD_END AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.COST_OF_GOOD AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.MAT_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.LAB_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.BUR_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.OVH_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.SUB_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.MAT_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.LAB_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.BUR_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.OVH_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.SUB_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.DB_CURR AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.MFG_UPD_DATE AS STRING ) AS TIMESTAMP ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.INS_DATE AS STRING ) AS TIMESTAMP ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.UPD_DATE AS STRING ) AS TIMESTAMP ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.MISSING AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_CUR.REGION_CODE AS STRING ) AS STRING ) FROM EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_EXP_CUR )";

EXECUTE IMMEDIATE " CREATE OR REPLACE TABLE EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_COST_STD_ACT AS( SELECT 1 AS DUMMY) ";

EXECUTE IMMEDIATE "  CREATE OR REPLACE TABLE EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_SQ_COST_STD_ACT AS ( SELECT COST_STD_ACT.ITEM_ID AS ITEM_ID , COST_STD_ACT.DB_CODE AS DB_CODE , COST_STD_ACT.SITE_CODE AS SITE_CODE , COST_STD_ACT.COST_OF_GOOD AS COST_OF_GOOD , COST_STD_ACT.MAT_COST_TL AS MAT_COST_TL , COST_STD_ACT.LAB_COST_TL AS LAB_COST_TL , COST_STD_ACT.BUR_COST_TL AS BUR_COST_TL , COST_STD_ACT.OVH_COST_TL AS OVH_COST_TL , COST_STD_ACT.SUB_COST_TL AS SUB_COST_TL , COST_STD_ACT.MAT_COST_LL AS MAT_COST_LL , COST_STD_ACT.LAB_COST_LL AS LAB_COST_LL , COST_STD_ACT.BUR_COST_LL AS BUR_COST_LL , COST_STD_ACT.OVH_COST_LL AS OVH_COST_LL , COST_STD_ACT.SUB_COST_LL AS SUB_COST_LL , COST_STD_ACT.DB_CURR AS DB_CURR , COST_STD_ACT.MFG_UPD_DATE AS MFG_UPD_DATE , COST_STD_ACT.INS_DATE AS INS_DATE , COST_STD_ACT.UPD_DATE AS UPD_DATE , COST_STD_ACT.MISSING AS MISSING , COST_STD_ACT.REGION_CODE AS REGION_CODE FROM "||PRM_PARAM_SRC_CORE_DB||".COST_STD_ACT  COST_STD_ACT WHERE COST_STD_ACT.REGION_CODE='"||VAR_REGION_CODE||"' )";

EXECUTE IMMEDIATE "  CREATE OR REPLACE TABLE EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_EXP_STD AS ( SELECT M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.ITEM_ID AS ITEM_ID , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.DB_CODE AS DB_CODE , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.SITE_CODE AS SITE_CODE , 'A' AS COST_SET , "||VAR_PERIOD_START||"  AS PERIOD_START , "||VAR_PERIOD_END||" AS PERIOD_END , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.COST_OF_GOOD AS COST_OF_GOOD , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.MAT_COST_TL AS MAT_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.LAB_COST_TL AS LAB_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.BUR_COST_TL AS BUR_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.OVH_COST_TL AS OVH_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.SUB_COST_TL AS SUB_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.MAT_COST_LL AS MAT_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.LAB_COST_LL AS LAB_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.BUR_COST_LL AS BUR_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.OVH_COST_LL AS OVH_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.SUB_COST_LL AS SUB_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.DB_CURR AS DB_CURR , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.MFG_UPD_DATE AS MFG_UPD_DATE , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.INS_DATE AS INS_DATE , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.UPD_DATE AS UPD_DATE , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.MISSING AS MISSING , M_ITEM_COST_YEARLY_SQ_COST_STD_ACT.REGION_CODE AS REGION_CODE FROM EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_SQ_COST_STD_ACT )";

EXECUTE IMMEDIATE "  INSERT INTO "||PRM_PARAM_CORE_DB||"."||PRM_PARAM_TARGET_TABLENAME||" ( ITEM_ID , DB_CODE , SITE_CODE , COST_SET , PERIOD_START , PERIOD_END , COST_OF_GOOD , MAT_COST_TL , LAB_COST_TL , BUR_COST_TL , OVH_COST_TL , SUB_COST_TL , MAT_COST_LL , LAB_COST_LL , BUR_COST_LL , OVH_COST_LL , SUB_COST_LL , DB_CURR , MFG_UPD_DATE , INS_DATE , UPD_DATE , MISSING , REGION_CODE ) ( SELECT SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.ITEM_ID AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.DB_CODE AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.SITE_CODE AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.COST_SET AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.PERIOD_START AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.PERIOD_END AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.COST_OF_GOOD AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.MAT_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.LAB_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.BUR_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.OVH_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.SUB_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.MAT_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.LAB_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.BUR_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.OVH_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.SUB_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.DB_CURR AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.MFG_UPD_DATE AS STRING ) AS TIMESTAMP ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.INS_DATE AS STRING ) AS TIMESTAMP ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.UPD_DATE AS STRING ) AS TIMESTAMP ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.MISSING AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_STD.REGION_CODE AS STRING ) AS STRING ) FROM EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_EXP_STD )";

EXECUTE IMMEDIATE " CREATE OR REPLACE TABLE EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_COST_MFG_ACT AS( SELECT 1 AS DUMMY) ";

EXECUTE IMMEDIATE "  CREATE OR REPLACE TABLE EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT AS ( SELECT COST_MFG_ACT.ITEM_ID AS ITEM_ID , COST_MFG_ACT.DB_CODE AS DB_CODE , COST_MFG_ACT.SITE_CODE AS SITE_CODE , COST_MFG_ACT.COST_OF_GOOD AS COST_OF_GOOD , COST_MFG_ACT.MAT_COST_TL AS MAT_COST_TL , COST_MFG_ACT.LAB_COST_TL AS LAB_COST_TL , COST_MFG_ACT.BUR_COST_TL AS BUR_COST_TL , COST_MFG_ACT.OVH_COST_TL AS OVH_COST_TL , COST_MFG_ACT.SUB_COST_TL AS SUB_COST_TL , COST_MFG_ACT.MAT_COST_LL AS MAT_COST_LL , COST_MFG_ACT.LAB_COST_LL AS LAB_COST_LL , COST_MFG_ACT.BUR_COST_LL AS BUR_COST_LL , COST_MFG_ACT.OVH_COST_LL AS OVH_COST_LL , COST_MFG_ACT.SUB_COST_LL AS SUB_COST_LL , COST_MFG_ACT.DB_CURR AS DB_CURR , COST_MFG_ACT.MFG_UPD_DATE AS MFG_UPD_DATE , COST_MFG_ACT.INS_DATE AS INS_DATE , COST_MFG_ACT.UPD_DATE AS UPD_DATE , COST_MFG_ACT.MISSING AS MISSING , COST_MFG_ACT.REGION_CODE AS REGION_CODE FROM "||PRM_PARAM_SRC_CORE_DB||".COST_MFG_ACT  COST_MFG_ACT WHERE COST_MFG_ACT.REGION_CODE='"||VAR_REGION_CODE||"' )";

EXECUTE IMMEDIATE "  CREATE OR REPLACE TABLE EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_EXP_MFG AS ( SELECT M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.ITEM_ID AS ITEM_ID , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.DB_CODE AS DB_CODE , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.SITE_CODE AS SITE_CODE , 'M' AS COST_SET , "||VAR_PERIOD_START||"  AS PERIOD_START , "||VAR_PERIOD_END||" AS PERIOD_END , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.COST_OF_GOOD AS COST_OF_GOOD , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.MAT_COST_TL AS MAT_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.LAB_COST_TL AS LAB_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.BUR_COST_TL AS BUR_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.OVH_COST_TL AS OVH_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.SUB_COST_TL AS SUB_COST_TL , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.MAT_COST_LL AS MAT_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.LAB_COST_LL AS LAB_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.BUR_COST_LL AS BUR_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.OVH_COST_LL AS OVH_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.SUB_COST_LL AS SUB_COST_LL , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.DB_CURR AS DB_CURR , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.MFG_UPD_DATE AS MFG_UPD_DATE , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.INS_DATE AS INS_DATE , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.UPD_DATE AS UPD_DATE , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.MISSING AS MISSING , M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT.REGION_CODE AS REGION_CODE FROM EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT )";

EXECUTE IMMEDIATE "  INSERT INTO "||PRM_PARAM_CORE_DB||"."||PRM_PARAM_TARGET_TABLENAME||" ( ITEM_ID , DB_CODE , SITE_CODE , COST_SET , PERIOD_START , PERIOD_END , COST_OF_GOOD , MAT_COST_TL , LAB_COST_TL , BUR_COST_TL , OVH_COST_TL , SUB_COST_TL , MAT_COST_LL , LAB_COST_LL , BUR_COST_LL , OVH_COST_LL , SUB_COST_LL , DB_CURR , MFG_UPD_DATE , INS_DATE , UPD_DATE , MISSING , REGION_CODE ) ( SELECT SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.ITEM_ID AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.DB_CODE AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.SITE_CODE AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.COST_SET AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.PERIOD_START AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.PERIOD_END AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.COST_OF_GOOD AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.MAT_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.LAB_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.BUR_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.OVH_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.SUB_COST_TL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.MAT_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.LAB_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.BUR_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.OVH_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.SUB_COST_LL AS STRING ) AS NUMERIC ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.DB_CURR AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.MFG_UPD_DATE AS STRING ) AS TIMESTAMP ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.INS_DATE AS STRING ) AS TIMESTAMP ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.UPD_DATE AS STRING ) AS TIMESTAMP ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.MISSING AS STRING ) AS STRING ) , SAFE_CAST ( SAFE_CAST ( M_ITEM_COST_YEARLY_EXP_MFG.REGION_CODE AS STRING ) AS STRING ) FROM EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_EXP_MFG )";

EXECUTE IMMEDIATE " DROP TABLE IF EXISTS EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_COST_CUR_ACT ";

EXECUTE IMMEDIATE " DROP TABLE IF EXISTS EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_SQ_COST_CUR_ACT ";

EXECUTE IMMEDIATE " DROP TABLE IF EXISTS EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_EXP_CUR ";

EXECUTE IMMEDIATE " DROP TABLE IF EXISTS EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_COST_STD_ACT ";

EXECUTE IMMEDIATE " DROP TABLE IF EXISTS EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_SQ_COST_STD_ACT ";

EXECUTE IMMEDIATE " DROP TABLE IF EXISTS EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_EXP_STD ";

EXECUTE IMMEDIATE " DROP TABLE IF EXISTS EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_COST_MFG_ACT ";

EXECUTE IMMEDIATE " DROP TABLE IF EXISTS EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_SQ_COST_MFG_ACT ";

EXECUTE IMMEDIATE " DROP TABLE IF EXISTS EDW_DATASET_LND_STG.M_ITEM_COST_YEARLY_EXP_MFG ";
END
;
 
CALL EDW_DATASET_LND_STG.S_M_ALT_UOM_DCS("ALT_UOM","ALT_UOM","ALT_UOM","U","PROD_DCS_LND_P","DCS_CORE_V","DCS_LND_V","DCS_LND_STG_DC_V","ALT_UOM","ALT_UOM","DCS_LND_STG_DC","ALT_UOM");
CALL EDW_DATASET_LND_STG.S_M_ALT_UOM_DC("ALT_UOM","ALT_UOM_INS","ALT_UOM","ALT_UOM_INS","ALT_UOM_INS","ALT_UOM","U","ALT_UOM","LOG_INFORMATICA","DB_MASTER","DCS_CORE_P","DCS_CORE_V","DCS_CORE","DCS_LND_STG_DC_V","ALT_UOM","ALT_UOM","ALT_UOM_INS","DCS_CORE","4","ALT_UOM","ALT_UOM_INS");

